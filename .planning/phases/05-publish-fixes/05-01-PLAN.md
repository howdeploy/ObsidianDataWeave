---
phase: 05-publish-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - requirements.txt
  - install.sh
  - README.md
  - config.example.toml
autonomous: true
gap_closure: true
requirements:
  - DIST-01
  - DIST-02
must_haves:
  truths:
    - "Running pip install -r requirements.txt on a clean venv installs PyYAML (python3 -c 'import yaml' succeeds)"
    - "Running bash install.sh installs pyyaml alongside python-docx for all package managers"
    - "README.md lines referencing the parser script say 'parse_docx.py' not 'parse_doc.py' in both EN and RU sections"
    - "config.example.toml has no [processing] section (dead config removed)"
  artifacts:
    - path: "requirements.txt"
      provides: "Python dependencies including PyYAML"
      contains: "PyYAML"
    - path: "install.sh"
      provides: "Cross-platform installer with PyYAML"
      contains: "pyyaml"
    - path: "README.md"
      provides: "Bilingual docs with correct script names"
      contains: "parse_docx.py"
    - path: "config.example.toml"
      provides: "Config template without dead keys"
---

<objective>
Close all gaps from v1.0 milestone audit: add PyYAML as declared dependency, fix README script name typo, remove dead config key. After this plan, the new-user E2E flow works on clean systems without pre-installed PyYAML.

Source: .planning/v1.0-MILESTONE-AUDIT.md gaps section
</objective>

<execution_context>
@/home/kosya/.claude/get-shit-done/workflows/execute-plan.md
@/home/kosya/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/v1.0-MILESTONE-AUDIT.md
@requirements.txt
@install.sh
@README.md
@config.example.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add PyYAML dependency to requirements.txt and install.sh</name>
  <files>requirements.txt, install.sh</files>
  <action>
1. **requirements.txt**: Add `PyYAML>=6.0` on a new line after the existing `python-docx` line. Do NOT remove or modify the existing line.

2. **install.sh**: In the `install_python_docx()` function, add `pyyaml` to every pip3 install command alongside python-docx:
   - Line 103 (pacman case): Change `pip3 install --break-system-packages python-docx` to `pip3 install --break-system-packages python-docx pyyaml`
   - Line 106 (catch-all case): Change `pip3 install python-docx` to `pip3 install python-docx pyyaml`

Do NOT rename the function or change any other logic. The guard `python3 -c "import docx"` stays as-is (PyYAML is installed alongside, not guarded separately — if python-docx is present, PyYAML was installed in the same step).
  </action>
  <verify>
Verify requirements.txt has 2 lines: `grep -c "." requirements.txt` returns 2. Verify PyYAML present: `grep "PyYAML" requirements.txt`. Verify install.sh has pyyaml: `grep -c "pyyaml" install.sh` returns 2 (one per case branch). Run `bash -n install.sh` for syntax check.
  </verify>
  <done>requirements.txt declares PyYAML>=6.0. install.sh installs pyyaml alongside python-docx for both pacman and non-pacman systems.</done>
</task>

<task type="auto">
  <name>Task 2: Fix README typo and remove dead config key</name>
  <files>README.md, config.example.toml</files>
  <action>
1. **README.md**: Fix the script name typo on two lines:
   - Line 62 (EN section): Change `scripts/parse_doc.py` to `scripts/parse_docx.py`
   - Line 182 (RU section): Change `scripts/parse_doc.py` to `scripts/parse_docx.py`

   Use exact string replacement. Do NOT modify any other content.

2. **config.example.toml**: Remove the `[processing]` section entirely (lines 14-15):
   ```
   [processing]
   default_note_type = "atomic"               # frontmatter note_type default
   ```
   Also remove the blank line before `[processing]` if it would leave a trailing blank line. The file should end after the `[rclone]` section.
  </action>
  <verify>
Verify README typo fixed: `grep -c "parse_doc\.py" README.md` returns 0. Verify correct name present: `grep -c "parse_docx\.py" README.md` returns 2+. Verify dead config removed: `grep -c "processing" config.example.toml` returns 0.
  </verify>
  <done>README.md references parse_docx.py in both EN and RU. config.example.toml has no dead [processing] section.</done>
</task>

</tasks>

<verification>
1. `grep "PyYAML" requirements.txt` — present
2. `grep -c "pyyaml" install.sh` — returns 2
3. `bash -n install.sh` — syntax check passes
4. `grep -c "parse_doc\.py" README.md` — returns 0 (typo gone)
5. `grep -c "parse_docx\.py" README.md` — returns 2+ (correct name)
6. `grep -c "processing" config.example.toml` — returns 0 (dead config gone)
7. `wc -l requirements.txt` — returns 2
</verification>

<success_criteria>
- PyYAML declared in requirements.txt and installed by install.sh for all package managers
- README references correct script name (parse_docx.py) in both EN and RU sections
- config.example.toml has no dead [processing] section
- All existing functionality unchanged (no regressions)
</success_criteria>

<output>
After completion, create `.planning/phases/05-publish-fixes/05-01-SUMMARY.md`
</output>
